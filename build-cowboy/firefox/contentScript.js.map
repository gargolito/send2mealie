{"version":3,"file":"contentScript.js","mappings":"mBAIO,MAAMA,EAAoB,CAC7B,iBACA,iBACA,kBACA,WACA,oBACA,kBACA,kBACA,WACA,mBACA,kBACA,kBACA,sBACA,sBACA,4BACA,qBCbEC,EAAyB,oBAAZC,QAA0BA,QAAUC,QAEvD,WAEE,MAAMC,EAAS,uBACf,GAAIC,SAASC,eAAeF,GAAS,OAErC,MAAMG,EAAMF,SAASG,cAAc,UAkDnCC,eAAeC,IACb,IACE,MAAMC,QAAaV,EAAIW,QAAQC,KAAKC,IAAI,CAAC,YAAa,oBAAsB,CAAC,EAC7E,IAAKH,EAAKI,YAAcJ,EAAKK,eAC3B,OAGFf,EAAIgB,QAAQC,YACV,CAAEC,KAAM,iBAAkBC,IAAKC,SAASC,MACvCC,IACKA,GAAUC,SACZjB,EAAIkB,YAAc,WAClBlB,EAAImB,MAAMC,WAAa,UACvBpB,EAAIqB,UAAW,EACfrB,EAAImB,MAAMG,QAAU,MACpBtB,EAAImB,MAAMI,OAAS,UACnBvB,EAAImB,MAAMK,cAAgB,SAIlC,CAAE,MAAOC,GACPC,QAAQC,MAAM,+CAChB,CACF,CAEAzB,eAAe0B,IACb,MACMC,EADW,IAAIC,IAAIhB,SAASC,MAAMgB,SAChBC,QAAQ,SAAU,IAE1C,IACE,MAAM5B,QAAaV,EAAIW,QAAQC,KAAKC,IAAI,CAAC,kBAAmB,YAAa,YAAa,oBAAsB,CAAC,EAGvG0B,EAAY7B,EAAK8B,iBAAmBzC,EACpC0C,EAAY/B,EAAK+B,WAAa,GAGpC,GAFmB,IAAIF,KAAcE,GAEtBC,KAAKC,GAAKR,EAAOS,SAASD,IAAK,CAC5C,IAAKjC,EAAKI,YAAcJ,EAAKK,eAC3B,OAIFf,EAAIgB,QAAQC,YACV,CAAEC,KAAM,eAAgBC,IAAKC,SAASC,MACrCC,IACKA,GAAUuB,WACRzC,SAAS0C,MAGX1C,SAAS0C,KAAKC,YAAYzC,GAC1BG,KAEAL,SAAS4C,iBAAiB,mBAAoB,KAC5C5C,SAAS0C,KAAKC,YAAYzC,GAC1BG,QAMZ,CACF,CAAE,MAAOsB,GACPC,QAAQC,MAAM,wCAAyCF,EACzD,CACF,CAlHAzB,EAAI2C,GAAK9C,EACTG,EAAIkB,YAAc,iBAClBlB,EAAImB,MAAMyB,SAAW,QACrB5C,EAAImB,MAAM0B,OAAS,OACnB7C,EAAImB,MAAM2B,MAAQ,OAClB9C,EAAImB,MAAM4B,OAAS,aACnB/C,EAAImB,MAAMC,WAAa,UACvBpB,EAAImB,MAAM6B,MAAQ,QAClBhD,EAAImB,MAAM8B,OAAS,OACnBjD,EAAImB,MAAM+B,aAAe,MACzBlD,EAAImB,MAAMgC,QAAU,YACpBnD,EAAImB,MAAMiC,UAAY,4BACtBpD,EAAImB,MAAMI,OAAS,UACnBvB,EAAImB,MAAMkC,KAAO,yHAGjBrD,EAAI0C,iBAAiB,QAASxC,UAC5B,MAAME,QAAaV,EAAIW,QAAQC,KAAKC,IAAI,CAAC,YAAa,oBAAsB,CAAC,GACvE,UAAEC,EAAS,eAAEC,GAAmBL,EACjCI,GAAcC,GAInBT,EAAIkB,YAAc,aAClBlB,EAAImB,MAAMC,WAAa,UACvBpB,EAAImB,MAAMG,QAAU,MACpBtB,EAAImB,MAAMK,cAAgB,OAC1B9B,EAAIgB,QAAQC,YAAY,CAAEC,KAAM,eAAgBC,IAAKC,SAASC,MAASC,IACrEhB,EAAImB,MAAMG,QAAU,IACpBtB,EAAImB,MAAMK,cAAgB,OACtBR,GAAUsC,SACZtD,EAAImB,MAAMC,WAAa,UACvBpB,EAAIkB,YAAc,WAClBlB,EAAIqB,UAAW,EACfrB,EAAImB,MAAMI,OAAS,UACnBvB,EAAImB,MAAMK,cAAgB,QACjBR,GAAUuC,WACnBvD,EAAImB,MAAMC,WAAa,YACvBpB,EAAIkB,YAAc,kBAClBsC,WAAW,IAAOxD,EAAIkB,YAAc,iBAAmB,OAGvDlB,EAAIkB,YAAc,QAClBsC,WAAW,IAAOxD,EAAIkB,YAAc,iBAAmB,SAvBzDxB,EAAIgB,QAAQC,YAAY,CAAEC,KAAM,gBAgGR,YAAxBd,SAAS2D,WACX3D,SAAS4C,iBAAiB,mBAAoBd,GAE9CA,GAEH,CA/HD,E","sources":["webpack://send2mealie/./src/cowboy/whitelist.js","webpack://send2mealie/./src/cowboy/contentScript.js"],"sourcesContent":["// Default list of supported recipe domains.\n// These domains define where the extension may operate by default.\n// Additional sites may be added only with explicit user approval\n// via Chrome's optional host permission prompts.\nexport const DEFAULT_WHITELIST = [\n    \"allrecipes.com\",\n    \"eatingwell.com\",\n    \"foodnetwork.com\",\n    \"food.com\",\n    \"simplyrecipes.com\",\n    \"seriouseats.com\",\n    \"budgetbytes.com\",\n    \"tasty.co\",\n    \"tastykitchen.com\",\n    \"skinnytaste.com\",\n    \"bbcgoodfood.com\",\n    \"thepioneerwoman.com\",\n    \"cooking.nytimes.com\",\n    \"sallysbakingaddiction.com\",\n    \"thespruceeats.com\"\n];\n","import { DEFAULT_WHITELIST } from './whitelist.js';\n// Content script responsible for displaying the \"Send to Mealie\" button\n// on user-approved recipe websites and coordinating recipe detection.\n// This script does not scrape page content or transmit browsing data.\n\n// Use browser namespace (Firefox) if available, otherwise chrome\nconst api = typeof browser !== 'undefined' ? browser : chrome;\n\n(function () {\n  // Prevents duplicate UI injection on the same page\n  const BTN_ID = \"add-to-mealie-button\";\n  if (document.getElementById(BTN_ID)) return;\n\n  const btn = document.createElement(\"button\");\n  btn.id = BTN_ID;\n  btn.textContent = \"Send to Mealie\";\n  btn.style.position = \"fixed\";\n  btn.style.bottom = \"20px\";\n  btn.style.right = \"20px\";\n  btn.style.zIndex = \"2147483647\";\n  btn.style.background = \"#E58325\";\n  btn.style.color = \"white\";\n  btn.style.border = \"none\";\n  btn.style.borderRadius = \"6px\";\n  btn.style.padding = \"10px 14px\";\n  btn.style.boxShadow = \"0 2px 6px rgba(0,0,0,0.2)\";\n  btn.style.cursor = \"pointer\";\n  btn.style.font = \"14px/1.2 -apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,\\\"Fira Sans\\\", \\\"Droid Sans\\\", \\\"Helvetica Neue\\\", Arial, sans-serif\";\n  // Handles explicit user action to send the current recipe URL to Mealie.\n  // Recipe import is never performed automatically.\n  btn.addEventListener(\"click\", async () => {\n    const data = await api.storage.sync.get([\"mealieUrl\", \"mealieApiToken\"]) || {};\n    const { mealieUrl, mealieApiToken } = data;\n    if (!mealieUrl || !mealieApiToken) {\n      api.runtime.sendMessage({ type: \"openPopup\" });\n      return;\n    }\n    btn.textContent = \"Sending...\";\n    btn.style.background = \"#9ACD32\";\n    btn.style.opacity = \"0.7\";\n    btn.style.pointerEvents = \"none\";\n    api.runtime.sendMessage({ type: \"createViaApi\", url: location.href }, (response) => {\n      btn.style.opacity = \"1\";\n      btn.style.pointerEvents = \"auto\";\n      if (response?.success) {\n        btn.style.background = \"#E58325\";\n        btn.textContent = \"Mealied!\";\n        btn.disabled = true;\n        btn.style.cursor = \"default\";\n        btn.style.pointerEvents = \"none\";\n      } else if (response?.duplicate) {\n        btn.style.background = \"#2098eeff\";\n        btn.textContent = \"Already saved âœ“\";\n        setTimeout(() => (btn.textContent = \"Send to Mealie\"), 3000);\n      } else {\n        // Errors are intentionally generic to avoid exposing sensitive details.\n        btn.textContent = \"Error\";\n        setTimeout(() => (btn.textContent = \"Send to Mealie\"), 2000);\n      }\n    });\n  });\n  // Checks whether the current recipe URL already exists in the user's Mealie instance.\n  // Only the page URL is sent; no page content is accessed or transmitted.\n  async function checkRecipeExists() {\n    try {\n      const data = await api.storage.sync.get(['mealieUrl', 'mealieApiToken']) || {};\n      if (!data.mealieUrl || !data.mealieApiToken) {\n        return;\n      }\n\n      api.runtime.sendMessage(\n        { type: \"checkDuplicate\", url: location.href },\n        (response) => {\n          if (response?.exists) {\n            btn.textContent = \"Mealied!\";\n            btn.style.background = \"#E58325\";\n            btn.disabled = true;\n            btn.style.opacity = \"0.7\";\n            btn.style.cursor = \"default\";\n            btn.style.pointerEvents = \"none\";\n          }\n        }\n      );\n    } catch (e) {\n      console.error('Send2Mealie: Error checking recipe existence');\n    }\n  }\n\n  async function shouldShowButton() {\n    const hostname = new URL(location.href).hostname;\n    const domain = hostname.replace(/^www\\./, '');\n\n    try {\n      const data = await api.storage.sync.get(['domainWhitelist', 'userSites', 'mealieUrl', 'mealieApiToken']) || {};\n      // Built-in supported domains combined with user-approved custom sites.\n      // No access occurs outside these domains.\n      const whitelist = data.domainWhitelist || DEFAULT_WHITELIST;\n      const userSites = data.userSites || [];\n      const allDomains = [...whitelist, ...userSites];\n\n      if (allDomains.some(w => domain.endsWith(w))) {\n        if (!data.mealieUrl || !data.mealieApiToken) {\n          return;\n        }\n        // Determines whether the current page URL can be scraped as a recipe by Mealie.\n        // This is a compatibility check using only the URL; no page content is transmitted.\n        api.runtime.sendMessage(\n          { type: \"isRecipePage\", url: location.href },\n          (response) => {\n            if (response?.isRecipe) {\n              if (document.body) {\n                // Injects a fixed-position UI button for user interaction.\n                // No existing page content or structure is modified.\n                document.body.appendChild(btn);\n                checkRecipeExists();\n              } else {\n                document.addEventListener('DOMContentLoaded', () => {\n                  document.body.appendChild(btn);\n                  checkRecipeExists();\n                });\n              }\n            }\n          }\n        );\n      }\n    } catch (e) {\n      console.error('Send2Mealie: Error checking whitelist', e);\n    }\n  }\n\n  if (document.readyState === 'loading') {\n    document.addEventListener('DOMContentLoaded', shouldShowButton);\n  } else {\n    shouldShowButton();\n  }\n})();\n"],"names":["DEFAULT_WHITELIST","api","browser","chrome","BTN_ID","document","getElementById","btn","createElement","async","checkRecipeExists","data","storage","sync","get","mealieUrl","mealieApiToken","runtime","sendMessage","type","url","location","href","response","exists","textContent","style","background","disabled","opacity","cursor","pointerEvents","e","console","error","shouldShowButton","domain","URL","hostname","replace","whitelist","domainWhitelist","userSites","some","w","endsWith","isRecipe","body","appendChild","addEventListener","id","position","bottom","right","zIndex","color","border","borderRadius","padding","boxShadow","font","success","duplicate","setTimeout","readyState"],"ignoreList":[],"sourceRoot":""}